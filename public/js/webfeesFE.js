var ddSingleBill={pageSize:"LEGAL",pageMargins:[30,10,5,5],content:[{style:"tableExample",table:{widths:[540],body:[[{style:"dtable",table:{widths:[355,10,150],headerRows:1,body:[[{text:"<<CO_NAME>>",style:"CoName",colSpan:2,border:[!1,!1,!1,!1]},{},{text:" ",border:[!1,!1,!1,!1]}],[{text:"<<CO_DESCR>>",colSpan:2,border:[!1,!1,!1,!1]},{},{text:"Tel : <<CO_TEL>>",border:[!1,!1,!1,!1]}],[{text:"<<CO_ADD>>",colSpan:2,border:[!1,!1,!1,!0]},{},{text:"<<CO_EMAIL>>",border:[!1,!1,!1,!0]}]]}}],[{style:"dtable",table:{widths:[355,10,150],headerRows:1,body:[[{text:"To,",colSpan:3,border:[!1,!1,!1,!1]},{},{}],[{text:"<<PARTY_NM>>",colSpan:2,border:[!1,!1,!1,!1]},{},{text:"Bill No    : <<BILL_NO>>",border:[!1,!1,!1,!1]}],[{text:"<<PARTY_ADD1>>",colSpan:3,border:[!1,!1,!1,!1]},{},{}],[{text:"<<PARTY_ADD2>>",colSpan:2,border:[!1,!1,!1,!1]},{},{text:"Bill Date : <<BILL_DATE>>",border:[!1,!1,!1,!1]}],[{text:"<<PARTY_ADD3>>",colSpan:3,border:[!1,!1,!1,!1]},{},{}]]}}],[{style:"dtable",table:{widths:[20,355,50,80],headerRows:1,body:[[{text:"No",style:"tableHeader"},{text:"Particulars",style:"tableHeader",colSpan:2},{text:""},{text:"Amount",style:"tableHeader",alignment:"right"}],[{text:"<<LINE>>",alignment:"right"},{text:"<<BILL_TRAN>>",colSpan:2},{},{text:"<<TRAN_AMT>>",alignment:"right"}],["",{text:"",colSpan:2},{}," "],["",{text:"",colSpan:2},{}," "],["",{text:"",colSpan:2},{}," "],["",{text:"",colSpan:2},{}," "],["",{text:"",colSpan:2},{}," "],["",{text:"",colSpan:2},{}," "],["",{text:"",colSpan:2},{}," "],["",{text:"",colSpan:2},{}," "],[{text:"Please pay by A/c. Payee's Cheque Only.",colSpan:2},{},{text:"Total :",alignment:"right"},{text:"<<TOT_AMT>>",alignment:"right",style:"tableHeader"}]]},layout:"billtblLayout"}],[{style:"dtable",table:{widths:[250,10,255],body:[[{text:"<<AMTINWORDS>>",colSpan:3,border:[!1,!1,!1,!1]},"",""],[{text:"E.& O. E.",border:[!1,!1,!1,!1]},{text:" ",border:[!1,!1,!1,!1]},{text:"For <<CO_NAME>>,",style:"tableHeader",alignment:"right",border:[!1,!1,!1,!1]}],[{text:"Bank : <<BANK_NAME>>",colSpan:2,border:[!1,!1,!1,!1]},{},{text:" ",border:[!1,!1,!1,!1]}],[{text:"IFSC : <<IFSC>> / Account No : <<BANK_ACC>> ",colSpan:2,border:[!1,!1,!1,!0]},{},{text:".",style:"tableHeader",alignment:"right",border:[!1,!1,!1,!0]}]]}}],[{text:"Developed by A. V. Solutions",style:"copyrights"}]]},layout:"noBorders"}],styles:{header:{fontSize:18,bold:!0,margin:[0,0,0,10]},copyrights:{fontSize:10,bold:!1,italics:!0,margin:[0,0,0,10]},subheader:{fontSize:16,bold:!0,margin:[0,10,0,5]},tableExample:{margin:[0,5,0,15]},tableHeader:{bold:!0,fontSize:12,color:"black"},CoName:{bold:!0,fontSize:18,color:"black"}},defaultStyle:{fontSize:10}},ddOSReg={pageSize:"A4",pageMargins:[30,10,10,10],pageNum:function(currentPage,pageCount){return currentPage.toString()+" of "+pageCount},content:[{style:"tableExample",table:{widths:[540],headerRows:3,body:[[{style:"dtable",table:{widths:[500],headerRows:1,body:[[{text:"H. B. Gala & Co. & Associated Firms",style:"CoName",alignment:"center",border:[!1,!1,!1,!1]}],[{text:"Outstanding bills",style:"header",alignment:"center",border:[!1,!1,!1,!1]}],[{text:"As on <<ASON_DT>>",style:"header",alignment:"center",border:[!1,!1,!1,!1]}]]}}],[{style:"dtable",table:{widths:[355,10,150],headerRows:1,body:[[{text:"Print Date : <<PRINT_DT>>",colSpan:2,border:[!1,!1,!1,!0]},{},{text:"Page No : <<PAGE_NO>>",border:[!1,!1,!1,!0]}]]}}],[{style:"dtable",table:{widths:[160,80,30,55,50,50,50],body:[[{text:"Paryt Name",style:"tableHeader",border:[!1,!1,!1,!1]},{text:"Co. Name",style:"tableHeader",border:[!1,!1,!1,!1]},{text:"---- Bill ----",style:"tableHeader",colSpan:3,alignment:"center",border:[!1,!1,!1,!1]},{},{},{text:"Rcpt",style:"tableHeader",alignment:"right",border:[!1,!1,!1,!1]},{text:"Bal",style:"tableHeader",alignment:"right",border:[!1,!1,!1,!1]}],[{text:"",border:[!1,!1,!1,!0]},{text:"",border:[!1,!1,!1,!0]},{text:"No",style:"tableHeader",alignment:"center",border:[!1,!1,!1,!0]},{text:"Date",style:"tableHeader",alignment:"right",border:[!1,!1,!1,!0]},{text:"Amt",style:"tableHeader",alignment:"right",border:[!1,!1,!1,!0]},{text:"Amt",style:"tableHeader",alignment:"right",border:[!1,!1,!1,!0]},{text:"Amt",style:"tableHeader",alignment:"right",border:[!1,!1,!1,!0]}]]}}],[{style:"dtable",table:{widths:[160,80,30,55,50,50,50],body:[[{text:"Group No : <<GROUP_ID>>",style:"GrpName",border:[!1,!1,!1,!1],colSpan:7},{},{},{},{},{},{}],[{text:"<<PARTY_NAME>>",border:[!1,!1,!1,!1]},{text:"<<CO_NAME>>",style:"subheader",border:[!1,!1,!1,!1]},{text:"<<BILL>>",alignment:"right",border:[!1,!1,!1,!1]},{text:"<<BILL_DT>>",alignment:"right",border:[!1,!1,!1,!1]},{text:"<<BILL_AMT>>",alignment:"right",border:[!1,!1,!1,!1]},{text:"<<RCPT_AMT>>",alignment:"right",border:[!1,!1,!1,!1]},{text:"<<BAL_AMT>>",alignment:"right",border:[!1,!1,!1,!1]}],[{text:"",border:[!1,!1,!1,!0]},{text:"",border:[!1,!1,!1,!0]},{text:"Group Total :",alignment:"right",colSpan:2,border:[!1,!1,!1,!0]},{},{text:"<<GRP_BILL_TOT>>",alignment:"right",border:[!1,!0,!1,!0]},{text:"<<GRP_RCPT_TOT>>",alignment:"right",border:[!1,!0,!1,!0]},{text:"<<GRP_BAL_TOT>>",alignment:"right",border:[!1,!0,!1,!0]}]]}}],[{text:"Developed by A. V. Solutions",style:"copyrights",border:[!1,!1,!1,!1]}]]},layout:"noBorders"}],styles:{header:{fontSize:12,bold:!0,margin:[0,0,0,10]},copyrights:{fontSize:10,bold:!1,italics:!0,margin:[0,0,0,10]},subheader:{fontSize:8,bold:!1},tableExample:{margin:[0,5,0,15]},tableHeader:{bold:!0,fontSize:12,color:"black"},GrpName:{bold:!0,fontSize:10,decoration:"underline"},CoName:{bold:!0,fontSize:18,color:"black"}},defaultStyle:{fontSize:10}},ddbillReg={pageSize:"A4",pageOrientation:"landscape",pageMargins:[30,10,5,30],pageNum:function(currentPage,pageCount){return currentPage.toString()+" of "+pageCount},content:[{style:"tableExample",table:{widths:[770],headerRows:3,body:[[{style:"dtable",table:{widths:[770],headerRows:1,body:[[{text:"<<CO_NAME>>",style:"CoName",alignment:"center",border:[!1,!1,!1,!1]}],[{text:"Bill Register",style:"header",alignment:"center",border:[!1,!1,!1,!1]}],[{text:"for the period from <<FROM_DT>> to <<TO_DT>>",style:"header",alignment:"center",border:[!1,!1,!1,!1]}]]}}],[{style:"dtable",table:{widths:[355,265,150],headerRows:1,body:[[{text:"Print Date : <<PRINT_DT>>",colSpan:2},{},{text:"Page No : <<PAGE_NO>>"}]]},layout:"noBorders"}],[{style:"dtable",table:{widths:[25,55,150,40,50,50,50,50,50,50,50,50,50,50],body:[[{text:"Bill No",border:[!1,!0,!1,!1]},{text:"Bill Date",border:[!1,!0,!1,!1]},{text:"Party Name",border:[!1,!0,!1,!1]},{text:"File No",alignment:"center",border:[!1,!0,!1,!1]},{text:"<<COL1HDR1>>",alignment:"center",border:[!1,!0,!1,!1]},{text:"<<COL1HDR2>>",alignment:"center",border:[!1,!0,!1,!1]},{text:"<<COL1HDR3>>",alignment:"center",border:[!1,!0,!1,!1]},{text:"<<COL1HDR4>>",alignment:"center",border:[!1,!0,!1,!1]},{text:"<<COL1HDR5>>",alignment:"center",border:[!1,!0,!1,!1]},{text:"<<COL1HDR6>>",alignment:"center",border:[!1,!0,!1,!1]},{text:"<<COL1HDR7>>",alignment:"center",border:[!1,!0,!1,!1]},{text:"<<COL1HDR8>>",alignment:"center",border:[!1,!0,!1,!1]},{text:"Previous",alignment:"center",border:[!1,!0,!1,!1]},{text:"Total",alignment:"right",border:[!1,!0,!1,!1]}],[{text:" ",border:[!1,!1,!1,!0]},{text:" ",border:[!1,!1,!1,!0]},{text:"",alignment:"center",border:[!1,!1,!1,!0]},{text:"",alignment:"right",border:[!1,!1,!1,!0]},{text:"<COL2HDR1>>",alignment:"center",border:[!1,!1,!1,!0]},{text:"<COL2HDR2>>",alignment:"center",border:[!1,!1,!1,!0]},{text:"<COL2HDR3>>",alignment:"center",border:[!1,!1,!1,!0]},{text:"<COL2HDR4>>",alignment:"center",border:[!1,!1,!1,!0]},{text:"<COL2HDR5>>",alignment:"center",border:[!1,!1,!1,!0]},{text:"<COL2HDR6>>",alignment:"center",border:[!1,!1,!1,!0]},{text:"<COL2HDR7>>",alignment:"center",border:[!1,!1,!1,!0]},{text:"<COL2HDR8>>",alignment:"center",border:[!1,!1,!1,!0]},{text:"Balance",alignment:"center",border:[!1,!1,!1,!0]},{text:" ",border:[!1,!1,!1,!0]}]]}}],[{style:"dtable",table:{widths:[25,55,150,40,50,50,50,50,50,50,50,50,50,50],body:[[{text:"<<BILLNO>>",border:[!1,!1,!1,!1]},{text:"<<BILL_DT>>",border:[!1,!1,!1,!1]},{text:"<<PARTY_NAME>>",border:[!1,!1,!1,!1]},{text:"<<AC_CODE>>",border:[!1,!1,!1,!1]},{text:"<<COLAMT1>>",alignment:"right",border:[!1,!1,!1,!1]},{text:"<<COLAMT2>>",alignment:"right",border:[!1,!1,!1,!1]},{text:"<<COLAMT3>>",alignment:"right",border:[!1,!1,!1,!1]},{text:"<<COLAMT4>>",alignment:"right",border:[!1,!1,!1,!1]},{text:"<<COLAMT5>>",alignment:"right",border:[!1,!1,!1,!1]},{text:"<<COLAMT6>>",alignment:"right",border:[!1,!1,!1,!1]},{text:"<<COLAMT7>>",alignment:"right",border:[!1,!1,!1,!1]},{text:"<<COLAMT8>>",alignment:"right",border:[!1,!1,!1,!1]},{text:"<<OST>>",alignment:"right",border:[!1,!1,!1,!1]},{text:"<<COLTOT>>",alignment:"right",border:[!1,!1,!1,!1]}],[{text:" ",border:[!1,!1,!1,!1]},{text:"<<TRCD_DATA>>",colSpan:3,border:[!1,!1,!1,!1]},{},{},{},{},{},{},{},{},{},{},{},{}]]}}],[{style:"dtable",table:{widths:[25,55,150,40,50,50,50,50,50,50,50,50,50,50],body:[[{text:" ",border:[!1,!0,!1,!0]},{text:" ",border:[!1,!0,!1,!0]},{text:"Grand Total : ",border:[!1,!0,!1,!0]},{text:" ",border:[!1,!0,!1,!0]},{text:" ",alignment:"right",border:[!1,!0,!1,!0]},{text:" ",alignment:"right",border:[!1,!0,!1,!0]},{text:" ",alignment:"right",border:[!1,!0,!1,!0]},{text:" ",alignment:"right",border:[!1,!0,!1,!0]},{text:" ",alignment:"right",border:[!1,!0,!1,!0]},{text:" ",alignment:"right",border:[!1,!0,!1,!0]},{text:" ",alignment:"right",border:[!1,!0,!1,!0]},{text:" ",alignment:"right",border:[!1,!0,!1,!0]},{text:" ",alignment:"right",border:[!1,!0,!1,!0]},{text:"<<GTOT>>",alignment:"right",border:[!1,!0,!1,!0]}]]}}],[{text:"Developed by A. V. Solutions",style:"copyrights",border:[!1,!0,!1,!1]}]]},layout:"noBorders"}],styles:{header:{fontSize:12,bold:!0,margin:[0,0,0,10]},copyrights:{fontSize:10,bold:!1,italics:!0,margin:[0,0,0,10]},subheader:{fontSize:8,bold:!1},tableExample:{margin:[0,5,0,15]},tableHeader:{bold:!0,fontSize:12,color:"black"},GrpName:{bold:!0,fontSize:10,decoration:"underline"},CoName:{bold:!0,fontSize:18,color:"black"}},defaultStyle:{fontSize:10}},ddLedger={pageSize:"A4",pageMargins:[30,10,10,30],pageNum:function(currentPage,pageCount){return currentPage.toString()+" of "+pageCount},content:[{style:"tableExample",table:{widths:[515],headerRows:2,body:[[{style:"dtable",table:{widths:[515],headerRows:3,body:[[{text:"<<CO_NAME>>",style:"CoName",alignment:"center",border:[!1,!1,!1,!1]}],[{text:"Ledgers",style:"header",alignment:"center",border:[!1,!1,!1,!1]}],[{text:"for the period from <<FROM_DT>> to <<TO_DT>>",style:"header",alignment:"center",border:[!1,!1,!1,!1]}]]}}],[{style:"dtable",table:{widths:[355,10,140],headerRows:1,body:[[{text:"Print Date : <<PRINT_DT>>",colSpan:2},{},{}]]},layout:"noBorders"}],[{style:"dtable",table:{widths:[55,50,250,50,50,50],body:[[{text:"<<AC_CODE>>",border:[!1,!1,!1,!1]},{text:"<<AC_NAME>>",colSpan:5,border:[!1,!1,!1,!1]},{},{},{},{}],[{text:"Date",border:[!1,!0,!1,!0]},{text:"No",border:[!1,!0,!1,!0]},{text:"Particulars",border:[!1,!0,!1,!0]},{text:"Bill Amount",alignment:"center",border:[!1,!0,!1,!0]},{text:"Rcpt Amount",alignment:"center",border:[!1,!0,!1,!0]},{text:"Balance",alignment:"center",border:[!1,!0,!1,!0]}],[{text:"<<TRAN_DT>>",border:[!1,!1,!1,!1]},{text:"<<NO>>",border:[!1,!1,!1,!1]},{text:"<<PARTICULARS>>",border:[!1,!1,!1,!1]},{text:"<<BILL_AMT>>",alignment:"right",border:[!1,!1,!1,!1]},{text:"<<RCPT_AMT>>",alignment:"right",border:[!1,!1,!1,!1]},{text:"<<BAL_AMT>>",alignment:"right",border:[!1,!1,!1,!1]}],[{text:" ",border:[!1,!0,!1,!0]},{text:" ",border:[!1,!0,!1,!0]},{text:"Net for the Period",border:[!1,!0,!1,!0]},{text:"<<BILLAMT_TOT>>",alignment:"right",border:[!1,!0,!1,!0]},{text:"<<RCPTAMT_TOT>>",alignment:"right",border:[!1,!0,!1,!0]},{text:"<<BALAMT_TOT>>",alignment:"right",border:[!1,!0,!1,!0]}],[{text:" ",border:[!1,!1,!1,!1]},{text:" ",border:[!1,!1,!1,!1]},{text:" ",border:[!1,!1,!1,!1]},{text:" ",border:[!1,!1,!1,!1]},{text:" ",border:[!1,!1,!1,!1]},{text:" ",border:[!1,!1,!1,!1]}]]}}],[{text:"Developed by A. V. Solutions",style:"copyrights",border:[!1,!0,!1,!1]}]]},layout:"noBorders"}],styles:{header:{fontSize:12,bold:!0,margin:[0,0,0,10]},copyrights:{fontSize:10,bold:!1,italics:!0,margin:[0,0,0,10]},subheader:{fontSize:8,bold:!1},tableExample:{margin:[0,5,0,15]},tableHeader:{bold:!0,fontSize:12,color:"black"},GrpName:{bold:!0,fontSize:10,decoration:"underline"},CoName:{bold:!0,fontSize:18,color:"black"}},defaultStyle:{fontSize:10}},ddrcptReg={pageSize:"A4",pageMargins:[30,10,10,10],footer:function(currentPage,pageCount){return{margin:10,columns:[{fontSize:9,text:[{text:"--------------------------------------------------------------------------\n",margin:[0,20]},{text:"Â© A. V. Solutions     Page : "+currentPage.toString()+" of "+pageCount}],alignment:"center"}]}},content:[{style:"tableExample",table:{widths:[540],headerRows:3,body:[[{style:"dtable",table:{widths:[500],headerRows:1,body:[[{text:"<<CO_NAME>>",style:"CoName",alignment:"center",border:[!1,!1,!1,!1]}],[{text:"Receipt Register",style:"header",alignment:"center",border:[!1,!1,!1,!1]}],[{text:"For the period from <<FROM_DT>> to <<TO_DT>>",style:"header",alignment:"center",border:[!1,!1,!1,!1]}]]}}],[{style:"dtable",table:{widths:[355,10,150],headerRows:1,body:[[{text:"Print Date : <<PRINT_DT>>",colSpan:2,border:[!1,!1,!1,!0]},{},{text:"Page No : "+this.footer,border:[!1,!1,!1,!0]}]]}}],[{style:"dtable",table:{widths:[160,50,50,55,50,50,50],body:[[{text:"Paryt Name",style:"tableHeader",alignment:"center",border:[!1,!1,!1,!0]},{text:"B. No",style:"tableHeader",alignment:"center",border:[!1,!1,!1,!0]},{text:"B. Amt",style:"tableHeader",alignment:"center",border:[!1,!1,!1,!0]},{text:"R. Date",style:"tableHeader",alignment:"center",border:[!1,!1,!1,!0]},{text:"Cash",style:"tableHeader",alignment:"center",border:[!1,!1,!1,!0]},{text:"Cheque",style:"tableHeader",alignment:"center",border:[!1,!1,!1,!0]},{text:"R. Amt",style:"tableHeader",alignment:"center",border:[!1,!1,!1,!0]}]]}}],[{style:"dtable",table:{widths:[160,50,50,55,50,50,50],body:[[{text:"<<PARTY_NAME>>",border:[!1,!1,!1,!1]},{text:"<<BILL>>",alignment:"center",border:[!1,!1,!1,!1]},{text:"<<BILL_AMT>>",alignment:"right",border:[!1,!1,!1,!1]},{text:"<<RCPT_DT>>",alignment:"right",border:[!1,!1,!1,!1]},{text:"<<CASH_AMT>>",alignment:"right",border:[!1,!1,!1,!1]},{text:"<<CHQ_AMT>>",alignment:"right",border:[!1,!1,!1,!1]},{text:"<<RCPT_AMT>>",alignment:"right",border:[!1,!1,!1,!1]}],[{text:"Total",border:[!1,!0,!1,!0]},{text:"",border:[!1,!0,!1,!0]},{text:"<<BILL_TOT>>",alignment:"right",border:[!1,!0,!1,!0]},{text:" ",alignment:"right",border:[!1,!0,!1,!0]},{text:"<<CASH_TOT>>",alignment:"right",border:[!1,!0,!1,!0]},{text:"<<CHQ_TOT>>",alignment:"right",border:[!1,!0,!1,!0]},{text:"<<RCPT_TOT>>",alignment:"right",border:[!1,!0,!1,!0]}]]}}],[{text:"Developed by A. V. Solutions",style:"copyrights",border:[!1,!1,!1,!1]}]]},layout:"noBorders"}],styles:{header:{fontSize:12,bold:!0,margin:[0,0,0,10]},copyrights:{fontSize:10,bold:!1,italics:!0,margin:[0,0,0,10]},subheader:{fontSize:8,bold:!1},tableExample:{margin:[0,5,0,15]},tableHeader:{bold:!0,fontSize:12,color:"black"},GrpName:{bold:!0,fontSize:10,decoration:"underline"},CoName:{bold:!0,fontSize:18,color:"black"}},defaultStyle:{fontSize:10}};function XMLstring(str){var rtnstr=str.replace(/&/g,"&amp;");return rtnstr=(rtnstr=rtnstr.replace(/'/g,"&apos;")).replace(/"/g,"&quot;")}function ShowSnackbar(msg,msgType){var x=document.getElementById("snackbar");x.className="show",x.innerHTML=msg,setTimeout(function(){x.className=x.className.replace("show","")},3e3)}function dateinDDMMYYYY(mDt){var dd=mDt.getDate(),mm=mDt.getMonth()+1;return dd<10&&(dd="0"+dd),mm<10&&(mm="0"+mm),dd+"/"+mm+"/"+mDt.getFullYear()}function dateinYYYYMMDD(mDt){var dd=mDt.getDate(),mm=mDt.getMonth()+1;return dd<10&&(dd="0"+dd),mm<10&&(mm="0"+mm),mDt.getFullYear()+"-"+mm+"-"+dd}function appToday(){var today=new Date,dd=today.getDate(),mm=today.getMonth()+1;return dd<10&&(dd="0"+dd),mm<10&&(mm="0"+mm),dd+"/"+mm+"/"+today.getFullYear()}function strDateDDMMYYYY(strDtYYYYMMDDD){return strDtYYYYMMDDD.substring(8,10)+"/"+strDtYYYYMMDDD.substring(5,7)+"/"+strDtYYYYMMDDD.substring(0,4)}function convertInWords(num){var a=["","One ","Two ","Three ","Four ","Five ","Six ","Seven ","Eight ","Nine ","Ten ","Eleven ","Twelve ","Thirteen ","Fourteen ","Fifteen ","Sixteen ","Seventeen ","Eighteen ","Nineteen "],b=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];if(9<(num=num.toString()).length)return"overflow";if(n=("000000000"+num).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/),n){var str="";return str+=0!=n[1]?(a[Number(n[1])]||b[n[1][0]]+" "+a[n[1][1]])+"Crore ":"",str+=0!=n[2]?(a[Number(n[2])]||b[n[2][0]]+" "+a[n[2][1]])+"Lakh ":"",str+=0!=n[3]?(a[Number(n[3])]||b[n[3][0]]+" "+a[n[3][1]])+"Thousand ":"",str+=0!=n[4]?(a[Number(n[4])]||b[n[4][0]]+" "+a[n[4][1]])+"Hundred ":"",str+=0!=n[5]?(""!=str?"And ":"")+(a[Number(n[5])]||b[n[5][0]]+" "+a[n[5][1]]):""}}function convertValidJSON(strVal){return strVal.replace(/'/g,"").replace(/"/g,"").replace(/\\/g,"-")}function numberWithCommas(x){return(x=null===x?0:x).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}var FeesApp=angular.module("FeesApp",[],function($interpolateProvider){$interpolateProvider.startSymbol("[["),$interpolateProvider.endSymbol("]]")});FeesApp.controller("UserListCntrl",["$scope","$http","$location",function($scope,$http,$location){$scope.pagetitle="Manage Users",$scope.sortColumn="USERID",$scope.sortReverse=!1,$scope.rtnMessage="",$scope.isRtnMsgErr="",$scope.confirmPassword="",$scope.edituser={},$scope.selectedComp={},$http.get("/company/listall").then(function(response){$scope.companylist=response.data}),$http.get("/company/yearslist").then(function(response){$scope.yearlist=response.data}),$scope.UpdtcPass=function(val){$scope.confirmPassword=val};var refresh=function(){$http.get("/users/listall").then(function(response){$scope.userlist=response.data,$scope.userdata="",$scope.confirmPassword=""})};refresh(),$scope.addUser=function(){$scope.rtnMessage="",$("#AddNewUser").modal()},$scope.registerNewUser=function(user){$http.post("/users/register",$scope.user).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error,refresh()})},$scope.editUser=function(row){var selectedUser=row.USERID;$http.get("/users/details/"+selectedUser).then(function(response){$scope.edituser=response.data}),$scope.rtnMessage="";var index=$scope.userlist.indexOf(row);-1!==($scope.currentIndex=index)&&$("#EditUser").modal()},$scope.modifyUpdateUser=function(editeduser){$http.post("/users/updateUser",editeduser).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error,refresh()})},$scope.changePwd=function(row){$scope.cpwd=row;var index=$scope.userlist.indexOf(row);-1!==($scope.currentIndex=index)&&$("#ChangePass").modal()},$scope.updateUserPwd=function(editeduser){$http.post("/users/changepass",editeduser).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error})},$scope.removeUser=function(row){$scope.deleteUSERID=row.USERID;var index=$scope.userlist.indexOf(row);-1!==($scope.currentIndex=index)&&$("#DeleteUser").modal()},$scope.deleteUser=function(userid,currentIndex){-1!==currentIndex&&$http.post("/users/delete/"+userid,[]).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error,$scope.userlist.splice(currentIndex,1),refresh()})},$scope.changeCurrentCo=function(comp,action){"change"==action&&$http.post("/users/updateCurrentCo",[comp]).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error});var approotpath=$location.protocol()+"://"+$location.host()+":"+$location.port();console.log(approotpath),window.open(approotpath,"_self")},$scope.changeCurrentYear=function(yr,action){"change"==action&&$http.post("/users/updateCurrentYr",[yr]).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error});var approotpath=$location.protocol()+"://"+$location.host()+":"+$location.port();console.log(approotpath),window.open(approotpath,"_self")},$scope.orderByMe=function(x){x===$scope.sortColumn?$scope.sortReverse=!$scope.sortReverse:($scope.sortColumn=x,$scope.sortReverse=!1)}}]),FeesApp.directive("compareTo",function(){return{require:"ngModel",$scope:{Password2:"=compareTo"},link:function($scope,element,attributes,modelVal){modelVal.$validators.compareTo=function(val){return val==$scope.confirmPassword},$scope.$watch("Password2",function(){modelVal.$validate()})}}}),FeesApp.directive("feesappPageHeader",function(){return{template:'<div class="page-header"><h3>[[pagetitle]]</h3></div>'}}),FeesApp.controller("companyCntrl",["$scope","$http","$rootScope","$location",function($scope,$http,$rootScope,$location){$scope.pagetitle="Manage Companies",$scope.sortColumn="CO_CODE",$scope.sortReverse=!1,$scope.rtnMessage="",$scope.isRtnMsgErr="",$scope.rtnMessageColor="alert alert-success",$scope.confirmPassword="",$scope.selectedComp={};var refresh=function(){$http.get("/company/listall").then(function(response){$scope.companylist=response.data,$scope.codata=""}),$scope.rtnMessageColor="Yes"==$scope.isRtnMsgErr?"alert alert-danger":"alert alert-success"};refresh(),$scope.addCompany=function(){$scope.rtnMessage="",$("#AddNewCompany").modal()},$scope.registerNewCompany=function(newcompany){$http.post("/company/register",newcompany).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error,refresh()})},$scope.editCompany=function(row){var selectedCoId=row.CO_CODE;$http.get("/company/details/"+selectedCoId).then(function(response){$scope.selectedCo=response.data}),$scope.selectedCo=row,$scope.rtnMessage="";var index=$scope.companylist.indexOf(row);-1!==($scope.currentIndex=index)&&$("#EditCompany").modal()},$scope.modifyCompany=function(company){$http.post("/company/update",company).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error,refresh()})},$scope.removeCompany=function(row){$scope.selectedCo=row,$scope.deleteCO_ID=row.CO_CODE;var index=$scope.companylist.indexOf(row);-1!==($scope.currentIndex=index)&&$("#DeleteCompany").modal()},$scope.deleteCompany=function(companyid,currentIndex){-1!==currentIndex&&$http.post("/company/delete/"+companyid,[]).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error,$scope.companylist.splice(currentIndex,1),refresh()})},$scope.changeCurrentCo=function(companyid,companyName){$rootScope.gblCoId=companyid,$rootScope.gblCoName=companyName;var approotpath=$location.protocol()+"://"+$location.host()+":"+$location.port();console.log(approotpath),window.open(approotpath,"_self")},$scope.orderByMe=function(x){x===$scope.sortColumn?$scope.sortReverse=!$scope.sortReverse:($scope.sortColumn=x,$scope.sortReverse=!1)}}]),FeesApp.controller("groupCntrl",["$scope","$http","$rootScope",function($scope,$http,$rootScope){$scope.pagetitle="Manage Groups",$scope.sortColumn="GRP_CODE",$scope.sortReverse=!1,$scope.rtnMessage="",$scope.isRtnMsgErr="",$scope.rtnMessageColor="alert alert-success",$scope.currentIndex=-1,$scope.selectedGrp={},$scope.pageDataLoaded=!1;var refresh=function(){$http.get("/groups/listall").then(function(response){$scope.grouplist=response.data,$scope.pageDataLoaded=!0}),$scope.rtnMessageColor="Yes"==$scope.isRtnMsgErr?"alert alert-danger":"alert alert-success"};refresh(),$scope.addGroup=function(){$scope.rtnMessage="",$("#AddNewGroup").modal()},$scope.registerNewGroup=function(newgroup){$http.post("/groups/register",newgroup).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error,ShowSnackbar($scope.rtnMessage,0),refresh()})},$scope.editGroup=function(row){var selectedGrpId=row.GRP_CODE;$http.get("/groups/details/"+selectedGrpId).then(function(response){$scope.selectedGrp=response.data}),$scope.selectedGrp=row,$scope.rtnMessage="";var index=$scope.grouplist.indexOf(row);-1!==($scope.currentIndex=index)&&$("#EditGroup").modal()},$scope.modifyGroup=function(grp){$http.post("/groups/update",grp).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error,ShowSnackbar($scope.rtnMessage,0),refresh()})},$scope.removeGroup=function(row){$scope.selectedGrp=row;var index=$scope.grouplist.indexOf(row);-1!==($scope.currentIndex=index)&&$("#DeleteGroup").modal()},$scope.deleteGroup=function(grpId,currentIndex){-1!==currentIndex&&$http.post("/groups/delete/"+grpId,[]).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error,$scope.grouplist.splice(currentIndex,1),refresh()})},$scope.orderByMe=function(x){x===$scope.sortColumn?$scope.sortReverse=!$scope.sortReverse:($scope.sortColumn=x,$scope.sortReverse=!1)}}]),FeesApp.controller("partyCntrl",["$scope","$http","$location",function($scope,$http,$location){$scope.pagetitle="Manage Parties",$scope.sortColumn="AC_CODE",$scope.sortReverse=!1,$scope.rtnMessage="",$scope.isRtnMsgErr="",$scope.lshowRtnMsg=!1,$scope.rtnMessageColor="alert alert-success",$scope.currentIndex=-1,$scope.selectedPrt={},$scope.isIncorrectGroup=!1,$scope.pageDataLoaded=!1;var refresh=function(){$http.get("/Parties/listall").then(function(response){$scope.partylist=response.data,$scope.pageDataLoaded=!0}),$http.get("/Parties/namelist").then(function(response){$scope.partynamelist=response.data}),$http.get("/Parties/grouplist").then(function(response){$scope.grouplist=response.data}),$scope.rtnMessageColor="Yes"==$scope.isRtnMsgErr?"alert alert-danger":"alert alert-success"};refresh(),$scope.getSelectedGrpID=function(grpNm,strAction){$http.get("/Parties/currentGroupID/"+grpNm).then(function(response){response.data.GRP_CODE?("ADD"==strAction?$scope.Prt.GRP_CODE=response.data.GRP_CODE:$scope.selectedPrt.GRP_CODE=response.data.GRP_CODE,$scope.isIncorrectGroup=!1):$scope.isIncorrectGroup=!0})},$scope.getSelectedGrpName=function(grpID,strAction){""!=grpID&&$http.get("/Parties/currentGroupNm/"+grpID).then(function(response){response.data.GRP_NAME?"ADD"==strAction?$scope.Prt.GRP_NAME=response.data.GRP_NAME:$scope.selectedPrt.GRP_NAME=response.data.GRP_NAME:$scope.isIncorrectGroup=!0})},$scope.addParty=function(){$scope.rtnMessage="",$("#AddNewParty").modal()},$scope.registerNewParty=function(newparty){$http.post("/Parties/register",newparty).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error,ShowSnackbar($scope.rtnMessage,0),refresh()})},$scope.editParty=function(row){var selectedPrtId=row.AC_CODE;$http.get("/Parties/details/"+selectedPrtId).then(function(response){$scope.selectedPrt=response.data}),$scope.rtnMessage="";var index=$scope.partylist.indexOf(row);-1!==($scope.currentIndex=index)&&$("#EditParty").modal()},$scope.modifyParty=function(party){$http.post("/Parties/update",party).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error,ShowSnackbar($scope.rtnMessage,0),refresh()})},$scope.removeParty=function(row){$scope.selectedPrt=row;var index=$scope.partylist.indexOf(row);-1!==($scope.currentIndex=index)&&$("#DeleteParty").modal()},$scope.deleteParty=function(prtId,currentIndex){-1!==currentIndex&&$http.post("/parties/delete/"+prtId,[]).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error,$scope.partylist.splice(currentIndex,1),refresh()})},$scope.getSelectedPrtID=function(PartyNm){""!=PartyNm&&$http.get("/parties/currentPartyID/"+PartyNm).then(function(response){response.data.AC_CODE?($scope.PrttoChange.AC_CODE=response.data.AC_CODE,$scope.isIncorrectGroup=!1):($scope.isIncorrectPartu=!0,$scope.PrttoChange.AC_CODE="Invalid Party !!")})},$scope.changePartyCode=function(prtCode,action){if("change"==action)$http.post("/Parties/changePartyCode",[$scope.PrttoChange]).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error,$scope.lshowRtnMsg=!0,$scope.rtnMessageColor="Yes"==$scope.isRtnMsgErr?"alert alert-danger":"alert alert-success",ShowSnackbar($scope.rtnMessage)});else{$scope.lshowRtnMsg=!1;var approotpath=$location.protocol()+"://"+$location.host()+":"+$location.port();console.log(approotpath),window.open(approotpath,"_self")}},$scope.orderByMe=function(x){x===$scope.sortColumn?$scope.sortReverse=!$scope.sortReverse:($scope.sortColumn=x,$scope.sortReverse=!1)}}]),FeesApp.controller("trcdCntrl",["$scope","$http","$rootScope",function($scope,$http,$rootScope){$scope.pagetitle="Manage Transaction Codes",$scope.sortColumn="TRCD",$scope.sortReverse=!1,$scope.rtnMessage="",$scope.isRtnMsgErr="",$scope.rtnMessageColor="alert alert-success",$scope.currentIndex=-1,$scope.pageDataLoaded=!1;var refresh=function(){$http.get("/trcds/listall").then(function(response){$scope.trcdlist=response.data,$scope.pageDataLoaded=!0}),$scope.rtnMessageColor="Yes"==$scope.isRtnMsgErr?"alert alert-danger":"alert alert-success"};refresh(),$scope.addTrcd=function(){$scope.rtnMessage="",$("#AddNewTrcd").modal()},$scope.registerNewTrcd=function(nTrcd){$http.post("/trcds/register",nTrcd).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error,refresh(),ShowSnackbar($scope.rtnMessage,0)})},$scope.editTrcd=function(row){var selectedTrcdId=row.TRCD;$http.get("/trcds/details/"+selectedTrcdId).then(function(response){$scope.selectedTrcd=response.data}),$scope.rtnMessage="";var index=$scope.trcdlist.indexOf(row);-1!==($scope.currentIndex=index)&&$("#EditTrcd").modal()},$scope.modifyTrcd=function(trcd){$http.post("/trcds/update",trcd).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error,refresh(),ShowSnackbar($scope.rtnMessage,0)})},$scope.removeTrcd=function(row){$scope.selectedTrcd=row;var index=$scope.trcdlist.indexOf(row);-1!==($scope.currentIndex=index)&&$("#DeleteTrcd").modal()},$scope.deleteTrcd=function(trcd,currentIndex){-1!==currentIndex&&$http.post("/trcds/delete/"+trcd,[]).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error,$scope.trcdlist.splice(currentIndex,1),refresh(),ShowSnackbar($scope.rtnMessage,0)})},$scope.orderByMe=function(x){x===$scope.sortColumn?$scope.sortReverse=!$scope.sortReverse:($scope.sortColumn=x,$scope.sortReverse=!1)}}]),FeesApp.controller("trcdsubCntrl",["$scope","$http","$rootScope",function($scope,$http,$rootScope){$scope.pagetitle="Manage Sub-transaction Codes",$scope.sortColumn="TRCD",$scope.sortReverse=!1,$scope.rtnMessage="",$scope.isRtnMsgErr="",$scope.rtnMessageColor="alert alert-success",$scope.currentIndex=-1,$scope.isIncorrectTrcd=!1,$scope.pageDataLoaded=!1;var refresh=function(){$http.get("/trcdsubs/listall").then(function(response){$scope.trcdsublist=response.data,$scope.pageDataLoaded=!0}),$http.get("/trcdsubs/trcdlist").then(function(response){$scope.trcdlist=response.data}),$scope.rtnMessageColor="Yes"==$scope.isRtnMsgErr?"alert alert-danger":"alert alert-success"};refresh(),$scope.getSelectedTrcdID=function(trcdNm){$http.get("/trcdsubs/currentTrcdID/"+trcdNm).then(function(response){response.data.TRCD?($scope.selectedTrcdsub.TRCD=response.data.TRCD,$scope.isIncorrectTrcd=!1):$scope.isIncorrectTrcd=!0})},$scope.addTrcdsub=function(){$scope.rtnMessage="",$("#AddNewTrcdsub").modal()},$scope.registerNewTrcdsub=function(nTrcdsub){$http.post("/trcdsubs/register",nTrcdsub).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error,refresh(),ShowSnackbar($scope.rtnMessage,0)})},$scope.editTrcdsub=function(row){var selectedTrcdId=row.TRCD+"-"+row.SUBCD;$http.get("/trcdsubs/details/"+selectedTrcdId).then(function(response){$scope.selectedTrcdsub=response.data}),$scope.rtnMessage="";var index=$scope.trcdsublist.indexOf(row);-1!==($scope.currentIndex=index)&&$("#editTrcdsub").modal()},$scope.modifyTrcdsub=function(trcdsub){$http.post("/trcdsubs/update",trcdsub).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error,refresh(),ShowSnackbar($scope.rtnMessage,0)})},$scope.removeTrcdsub=function(row){$scope.selectedTrcdsub=row;var index=$scope.trcdsublist.indexOf(row);-1!==($scope.currentIndex=index)&&$("#DeleteTrcdsub").modal()},$scope.deleteTrcdsub=function(trcd,currentIndex){-1!==currentIndex&&$http.post("/trcdsubs/delete/"+trcd,[]).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error,$scope.trcdlistsub.splice(currentIndex,1),refresh(),ShowSnackbar($scope.rtnMessage,0)})},$scope.orderByMe=function(x){x===$scope.sortColumn?$scope.sortReverse=!$scope.sortReverse:($scope.sortColumn=x,$scope.sortReverse=!1)}}]),FeesApp.controller("billsCntrl",["$scope","$http","$q","filterFilter",function($scope,$http,$q,filterFilter){$scope.pagetitle="Manage Bills",$scope.sortColumn="BILL_NO",$scope.sortReverse=!1,$scope.rtnMessage="",$scope.isRtnMsgErr="",$scope.rtnMessageColor="alert alert-success",$scope.currentIndex=-1,$scope.selectedBill={},$scope.newBill={},$scope.isbillschecked=!1,$scope.pageDataLoaded=!1,$scope.subcdlist={},$scope.selectedBillTran={},$scope.selectedTran={},$scope.newTranLine={},$scope.rowsubcdlist=[],$scope.transactionTotal=0;var refresh=function(){$http.get("/bills/listall").then(function(response){$scope.billslist=response.data,$scope.pageDataLoaded=!0}),$http.get("/bills/partylist").then(function(response){$scope.partylist=response.data}),$http.get("/bills/trcdlist").then(function(response){$scope.trcdlist=response.data}),$http.get("/bills/trcdsublist").then(function(response){$scope.subcdlist=response.data}),$scope.rtnMessageColor="Yes"==$scope.isRtnMsgErr?"alert alert-danger":"alert alert-success"};function getBillHeaders(cBilltoPrint,billId,blankBillContent){var billDate,rtnval="";billDate=cBilltoPrint.BILL_DT.substring(8,10)+"/"+cBilltoPrint.BILL_DT.substring(5,7)+"/"+cBilltoPrint.BILL_DT.substring(0,4),rtnval=(rtnval=(rtnval=blankBillContent).replace("<<BILL_NO>>",cBilltoPrint.BILL_NO)).replace("<<BILL_DATE>>",billDate);var acname=convertValidJSON(cBilltoPrint.AC_NAME);rtnval=rtnval.replace("<<PARTY_NM>>",acname);var prtAdd1=void 0===cBilltoPrint.ADDRESS1?" ":cBilltoPrint.ADDRESS1;prtAdd1=convertValidJSON(prtAdd1),rtnval=rtnval.replace("<<PARTY_ADD1>>",prtAdd1);var prtAdd2=void 0===cBilltoPrint.ADDRESS2?" ":cBilltoPrint.ADDRESS2;prtAdd2=convertValidJSON(prtAdd2),rtnval=rtnval.replace("<<PARTY_ADD2>>",prtAdd2);var prtAdd3=void 0===cBilltoPrint.ADDRESS3?" ":cBilltoPrint.ADDRESS3;prtAdd3=convertValidJSON(prtAdd3+=void 0===cBilltoPrint.ADDRESS4?"":", "+cBilltoPrint.ADDRESS4),rtnval=(rtnval=rtnval.replace("<<PARTY_ADD3>>",prtAdd3)).replace("<<TOT_AMT>>",numberWithCommas(cBilltoPrint.TOT_AMT));var AmtinWords="Rupees "+convertInWords(cBilltoPrint.TOT_AMT)+" Only.";return rtnval=rtnval.replace("<<AMTINWORDS>>",AmtinWords)}refresh(),$scope.selectAllBills=function(){for(var i=0;i<$scope.filteredbills.length;i++)$scope.filteredbills[i].CHECKED=!$scope.isbillschecked;$scope.isbillschecked=!$scope.isbillschecked},$scope.addBill=function(){$scope.rtnMessage="",$scope.selectedBill.BILLID=0,$scope.selectedBill.BILL_NO="",$scope.selectedBill.BILL_DT="",$scope.selectedBill.AC_CODE="",$scope.selectedBill.AC_NAME="",$scope.selectedBill.BILL_AMT=0,$scope.selectedBill.LASTBILLID=0,$scope.selectedBill.isClosed=!1,$scope.selectedBill.transactions=[],$scope.selectedBill.isClosedOld=$scope.selectedBill.isClosed,$scope.transactionTotal=0,$scope.selectedBill.selectedbillDt=new Date;var newTransact={BILLID:0,CO_CODE:0,BILL_NO:0,BILL_DT:"",TRCD:"",SUBCD:"",REMARKS:"",BILL_AMT:0};$scope.selectedBill.transactions.push(newTransact),$scope.selectedBillTran=$scope.selectedBill.transactions,$("#AddNewBill").modal()},$scope.registerNewbill=function(newbill){$http.post("/bills/register",newbill).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error,$scope.transactionTotal=0,refresh(),ShowSnackbar($scope.rtnMessage,0)})},$scope.editThisBill=function(row){var selectedBillId=row.BILLID;$http.get("/bills/billfulldata/"+selectedBillId).then(function(response){if($scope.selectedBill=response.data,$scope.selectedBill.isClosed="C"==$scope.selectedBill.CLIND||"Y"==$scope.selectedBill.CLIND,$scope.selectedBill.isClosedOld=$scope.selectedBill.isClosed,$scope.transactionTotal=$scope.selectedBill.TOT_AMT,$scope.selectedBill.selectedbillDt=new Date($scope.selectedBill.BILL_DT),$scope.selectedBillTran=$scope.selectedBill.transactions,0==$scope.selectedBillTran.length){var newTranLines={};newTranLines.BILLID=$scope.selectedBill.BILLID,newTranLines.CO_CODE=$scope.selectedBill.CO_CODE,newTranLines.BILL_NO=$scope.selectedBill.BILL_NO,newTranLines.BILL_DT=$scope.selectedBill.BILL_DT,newTranLines.TRCD="",newTranLines.TRCDDESC="",newTranLines.SUBCD="",newTranLines.SUBDESC="",newTranLines.REMARKS="",newTranLines.BILL_AMT=0,$scope.selectedBillTran.push($scope.newTranLine)}var index=$scope.billslist.indexOf(row);-1!==($scope.currentIndex=index)&&$("#EditBill").modal()})},$scope.modifyBill=function(sBilldata){$http.post("/bills/update",sBilldata).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error,refresh(),ShowSnackbar($scope.rtnMessage,0)})},$scope.removeBill=function(row){$scope.selectedBill=row;var index=$scope.billslist.indexOf(row);-1!==($scope.currentIndex=index)&&$("#DeleteBill").modal()},$scope.deleteBill=function(billtoDelete,currentIndex){var id="";-1!==currentIndex&&(id=billtoDelete.BILLID,$http.get("/bills/details/"+id).then(function(response){"Y"!=response.data.CLIND?$http.post("/bills/delete/"+id,[]).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error,$scope.billslist.splice(currentIndex,1),refresh(),ShowSnackbar($scope.rtnMessage,0)}):($scope.rtnMessage="Closed bill cannot be deleted",$scope.isRtnMsgErr=!0,ShowSnackbar($scope.rtnMessage,1))}))},$scope.getBillsData=function(){for(var delay=$q.defer(),urlcalls=[],i=0;i<$scope.billslist.length;i++)if($scope.billslist[i].CHECKED){var selectedBillId=$scope.billslist[i].BILLID;urlcalls.push($http.get("/bills/billfulldata/"+selectedBillId))}return $q.all(urlcalls).then(function(response){delay.resolve(response)}),delay.promise},$scope.PrintBills=function(){var win=window.open("","_blank"),pdfdd={};$q.defer();$http.get("/bills/CurrentCoData").then(function(response){if(response.data.CO_CODE){var coData=response.data;$scope.isIncorrectGroup=!1;var mydoc=JSON.stringify(ddSingleBill);mydoc=(mydoc=mydoc.replace(/<<CO_NAME>>/g,coData.COMPANY)).replace(/<<CO_DESCR>>/g,coData.CO_DESCR);var coAdd=" ";coAdd+=void 0===coData.ADD1?"":coData.ADD1,coAdd+=void 0===coData.ADD2?"":", "+coData.ADD2,coAdd+=void 0===coData.ADD3?"":", "+coData.ADD3,coAdd+=void 0===coData.CITY_DIST?"":" , Dist/City :"+coData.CITY_DIST,coAdd+=void 0===coData.STATE?"":", "+coData.STATE,coAdd+=void 0===coData.PIN?"":", PIN -"+coData.PIN,mydoc=mydoc.replace(/<<CO_ADD>>/g,coAdd);var coTel=" ";coTel+=void 0===coData.TEL1?"":coData.TEL1,coTel=(coTel+=void 0===coData.TEL2?"":"/"+coData.TEL2).substring(0,20),mydoc=mydoc.replace(/<<CO_TEL>>/g,coTel),coEmail=void 0===coData.EMAIL?"":"Email : "+coData.EMAIL,mydoc=mydoc.replace(/<<CO_EMAIL>>/g,coEmail);var coBankNm=void 0===coData.BANK_NAME?"":coData.BANK_NAME;coBankNm=coBankNm+" ["+(void 0===coData.AC_TYPE?"":coData.AC_TYPE)+" Account]";var coIFSC=void 0===coData.IFSC_CODE?"":coData.IFSC_CODE,coBankAcc=void 0===coData.AC_NUM?"":coData.AC_NUM;mydoc=(mydoc=(mydoc=mydoc.replace("<<BANK_NAME>>",coBankNm)).replace("<<IFSC>>",coIFSC)).replace("<<BANK_ACC>>",coBankAcc),pdfdd=JSON.parse(mydoc);var strsinglebillcontent=JSON.stringify(pdfdd.content[0]),strbillline=JSON.stringify(pdfdd.content[0].table.body[2][0].table.body[1]);JSON.stringify(pdfdd.content[0].table.body[2][0].table.body[2]),JSON.stringify(pdfdd.content[0].table.body[2][0].table.body[3]);$scope.getBillsData().then(function(response){for(var i=billCount=0;i<response.length;i++){var cBilltoPrint=response[i].data;strBillContent=getBillHeaders(cBilltoPrint,cBilltoPrint.BILLID,strsinglebillcontent);for(var billobj=JSON.parse(strBillContent),lineNo=1,itemNo=1,k=0;k<cBilltoPrint.transactions.length;k++){sline=cBilltoPrint.transactions[k];var tranName=sline.TRCDDESC;tranName=void 0===sline.SUBDESC?tranName:tranName+"-"+sline.SUBDESC,"OST"==sline.TRCD&&(tranName=tranName+" [ "+sline.REMARKS+" ]"),tranName=convertValidJSON(tranName);var strbline="";if(strbline=(strbline=(strbline=(strbline=strbillline).replace("<<LINE>>",itemNo.toString())).replace("<<BILL_TRAN>>",tranName)).replace("<<TRAN_AMT>>",numberWithCommas(sline.BILL_AMT)),billobj.table.body[2][0].table.body[lineNo]=JSON.parse(strbline),""!=sline.REMARKS&&"OST"!=sline.TRCD){lineNo++;strbline="";strbline=(strbline=(strbline=(strbline=strbillline).replace("<<LINE>>"," ")).replace("<<BILL_TRAN>>","  * "+convertValidJSON(sline.REMARKS))).replace("<<TRAN_AMT>>"," "),billobj.table.body[2][0].table.body[lineNo]=JSON.parse(strbline)}itemNo++,lineNo++}if(strBillContent=JSON.stringify(billobj),0<billCount){var newbillcontent=JSON.parse(strBillContent);pdfdd.content.push(newbillcontent)}else pdfdd.content[0]=JSON.parse(strBillContent);billCount++}pdfMake.tableLayouts={billtblLayout:{hLineWidth:function(i,node){return 0===i||i===node.table.body.length?2:1},vLineWidth:function(i,node){return 0===i||i===node.table.widths.length?2:1},hLineColor:function(i,node){return 0===i||i===node.table.body.length?"black":"gray"},vLineColor:function(i,node){return 0===i||i===node.table.widths.length?"black":"gray"}}},pdfMake.createPdf(pdfdd).open({},win)})}else $scope.isIncorrectGroup=!0})},$scope.updaterowsubcdlist=function(trcdid){$scope.rowsubcdlist=[];for(var i=0;i<$scope.subcdlist.length;i++){var item=$scope.subcdlist[i];item.TRCD==trcdid&&$scope.rowsubcdlist.push(item)}},$scope.getSelectedPrtName=function(PartyID){""!=PartyID&&$http.get("/bills/currentPartyNm/"+PartyID).then(function(response){response.data.AC_NAME?$scope.selectedBill.AC_NAME=response.data.AC_NAME:$scope.isIncorrectGroup=!0})},$scope.getSelectedPrtID=function(PartyNm,action){""!=PartyNm&&$http.get("/bills/currentPartyID/"+PartyNm).then(function(response){response.data.AC_CODE?($scope.selectedBill.AC_CODE=response.data.AC_CODE,"Add"==action&&$http.get("/bills/PreviousBal/"+$scope.selectedBill.AC_CODE).then(function(response){response.data.message||($scope.selectedBill.transactions[0].TRCD="OST",$scope.selectedBill.transactions[0].TRCDDESC="Previous Balance",$scope.selectedBill.transactions[0].SUBCD="",$scope.selectedBill.transactions[0].SUBDESC="",$scope.selectedBill.transactions[0].REMARKS="Bill No : "+response.data.BILL_NO+" dtd :  "+response.data.BILL_DT,$scope.selectedBill.transactions[0].BILL_AMT=response.data.BAL_AMT,$scope.selectedBill.LASTBILLID=response.data.BILLID,$scope.selectedBill.TOT_AMT=response.data.BAL_AMT,$scope.transactionTotal=response.data.BAL_AMT)}),$scope.isIncorrectGroup=!1):$scope.isIncorrectGroup=!0})},$scope.getTRCDID=function(trcdNm,index){var oldTRCD=$scope.selectedBillTran[index].TRCD;""!=trcdNm&&$http.get("/bills/currentTrcdID/"+trcdNm).then(function(response){response.data.TRCD?($scope.selectedBillTran[index].TRCD=response.data.TRCD,$scope.isIncorrectGroup=!1,$scope.updaterowsubcdlist($scope.selectedBillTran[index].TRCD),oldTRCD!=$scope.selectedBillTran[index].TRCD&&($scope.selectedBillTran[index].SUBCD="",$scope.selectedBillTran[index].SUBDESC="")):$scope.isIncorrectGroup=!0})},$scope.getSUBCDID=function(subcdnm,trcdid,index){var paramdata={};paramdata.subcdnm=subcdnm,paramdata.trcdid=trcdid,$http.post("/bills/currentSUBCDIDp",paramdata).then(function(response){response.data.SUBCD?($scope.selectedBillTran[index].SUBCD=response.data.SUBCD,$scope.isIncorrectGroup=!1):$scope.isIncorrectGroup=!0})},$scope.addBillline=function(row){$scope.newTranLine=angular.copy(row),$scope.newTranLine.TRCD="",$scope.newTranLine.TRCDDESC="",$scope.newTranLine.SUBCD="",$scope.newTranLine.SUBDESC="",$scope.newTranLine.REMARKS="",$scope.newTranLine.BILL_AMT=0,$scope.selectedBillTran.push($scope.newTranLine)},$scope.removeBillline=function(row,index){$scope.selectedBillTran.splice(index,1),$scope.getBillTotal(),0==$scope.selectedBillTran.length&&($scope.newTranLine.BILLID=$scope.selectedBill.BILLID,$scope.newTranLine.CO_CODE=$scope.selectedBill.CO_CODE,$scope.newTranLine.BILL_NO=$scope.selectedBill.BILL_NO,$scope.newTranLine.BILL_DT=$scope.selectedBill.BILL_DT,$scope.newTranLine.TRCD="",$scope.newTranLine.TRCDDESC="",$scope.newTranLine.SUBCD="",$scope.newTranLine.SUBDESC="",$scope.newTranLine.REMARKS="",$scope.newTranLine.BILL_AMT=0,$scope.selectedBillTran.push($scope.newTranLine))},$scope.getBillTotal=function(){for(var i=$scope.transactionTotal=0;i<$scope.selectedBillTran.length;i++)$scope.transactionTotal+=$scope.selectedBillTran[i].BILL_AMT;total=$scope.transactionTotal,$scope.selectedBill.BILL_AMT=total,$scope.selectedBill.TOT_AMT=total},$scope.orderByMe=function(x){x===$scope.sortColumn?$scope.sortReverse=!$scope.sortReverse:($scope.sortColumn=x,$scope.sortReverse=!1)}}]),FeesApp.controller("rcptCntrl",["$scope","$http","$q",function($scope,$http,$q){$scope.pagetitle="Manage Receipts",$scope.sortColumn="BILL_NO",$scope.sortReverse=!1,$scope.rtnMessage="",$scope.isRtnMsgErr="",$scope.rtnMessageColor="alert alert-success",$scope.pageDataLoaded=!1,$scope.currentIndex=-1,$scope.selectedBill={};var refresh=function(){$http.get("/receipts/listall").then(function(response){$scope.billslist=response.data,$scope.pageDataLoaded=!0}),$scope.rtnMessageColor="Yes"==$scope.isRtnMsgErr?"alert alert-danger":"alert alert-success"};refresh(),$scope.isValidDate=function(d){return d instanceof Date&&!isNaN(d)},$scope.enterReceipts=function(row){var selectedBillId=row.BILLID;$http.get("/receipts/details/"+selectedBillId).then(function(response){$scope.selectedBill=response.data,null==$scope.selectedBill.CASH1&&($scope.selectedBill.CASH1=0),null==$scope.selectedBill.CASH2&&($scope.selectedBill.CASH2=0),null==$scope.selectedBill.CHEQUE1&&($scope.selectedBill.CHEQUE1=0),null==$scope.selectedBill.CHEQUE2&&($scope.selectedBill.CHEQUE2=0),$scope.selectedBill.isClosed="C"==$scope.selectedBill.CLIND||"Y"==$scope.selectedBill.CLIND,$scope.selectedBill.isClosedOld=$scope.selectedBill.isClosed,$scope.selectedBill.selectedbillDt=new Date($scope.selectedBill.BILL_DT),null!=$scope.selectedBill.RCPT_DATE&&($scope.selectedBill.RcptDt1=new Date($scope.selectedBill.RCPT_DATE)),null!=$scope.selectedBill.RCPT_DATE2&&($scope.selectedBill.RcptDt2=new Date($scope.selectedBill.RCPT_DATE2));var index=$scope.billslist.indexOf(row);-1!==($scope.currentIndex=index)&&$("#EditReceipt").modal()})},$scope.modifyReceipt=function(sReceiptdata){$http.post("/receipts/update",sReceiptdata).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error,refresh()})},$scope.getRcptTotal=function(){$scope.selectedBill.CASH=$scope.selectedBill.CASH1+$scope.selectedBill.CASH2,$scope.selectedBill.CHEQUE=$scope.selectedBill.CHEQUE1+$scope.selectedBill.CHEQUE2,$scope.selectedBill.RCPT_AMT=$scope.selectedBill.CASH+$scope.selectedBill.CHEQUE,$scope.selectedBill.BAL_AMT=$scope.selectedBill.TOT_AMT-$scope.selectedBill.RCPT_AMT},$scope.orderByMe=function(x){x===$scope.sortColumn?$scope.sortReverse=!$scope.sortReverse:($scope.sortColumn=x,$scope.sortReverse=!1)}}]),FeesApp.controller("osCntrl",["$scope","$http","$rootScope","$location",function($scope,$http,$rootScope,$location){$scope.pagetitle="Outstandings",$scope.sortColumn="CO_CODE",$scope.sortReverse=!1,$scope.rtnMessage="",$scope.isRtnMsgErr="",$scope.rtnMessageColor="alert alert-success",$scope.confirmPassword="",$scope.selectedComp={},$scope.pageDataLoaded=!1;$http.get("/Outstandings/listall").then(function(response){$scope.companylist=response.data,$scope.codata="",$scope.pageDataLoaded=!0}),$http.get("../groups/listall").then(function(response){$scope.grouplist=response.data}),$scope.rtnMessageColor="Yes"==$scope.isRtnMsgErr?"alert alert-danger":"alert alert-success",$scope.PrintCancel=function(){var approotpath=$location.protocol()+"://"+$location.host()+":"+$location.port();console.log(approotpath),window.open(approotpath,"_self")},$scope.PrintOSReport=function(){var processreport=!0,selectioncount=0,dataOptions=JSON.parse('{"datascope" : 1, "grouplist" : "NA", "partylist" : "NA"}');if(2==$scope.ReportOption){for(var selgroupstring="(",i=0;i<$scope.grouplist.length;i++)$scope.grouplist[i].CHECKED&&(selgroupstring=selgroupstring+"'"+$scope.grouplist[i].GRP_CODE+"',",selectioncount+=1);selgroupstring=0<selectioncount?selgroupstring.substr(0,selgroupstring.length-1)+")":"( 'NA' )",dataOptions.datascope=2,dataOptions.grouplist=selgroupstring}if(2==$scope.ReportOption&&0==selectioncount&&(processreport=!1),processreport){var win=window.open("","_blank"),pdfdd={};$http.post("/outstandings/allOS",dataOptions).then(function(response){if(response.data){var osdata=response.data,mydoc=JSON.stringify(ddOSReg),todaysDt=appToday();mydoc=(mydoc=mydoc.replace(/<<ASON_DT>>/g,todaysDt)).replace(/<<PRINT_DT>>/g,todaysDt),pdfdd=JSON.parse(mydoc);var strGrpline=JSON.stringify(pdfdd.content[0].table.body[3][0].table.body[0]),strbillline=JSON.stringify(pdfdd.content[0].table.body[3][0].table.body[1]),strGrpTot=JSON.stringify(pdfdd.content[0].table.body[3][0].table.body[2]);pdfdd=JSON.parse(mydoc);for(var billDate="",grpid="",grpBillTot=0,grpRcptTot=0,grpBalTot=0,i=0;i<osdata.length;i++){if(osdata[i].GRP_CODE!=grpid){if(0!=i){var strline=(strline=(strline=strGrpTot.replace("<<GRP_BILL_TOT>>",numberWithCommas(grpBillTot))).replace("<<GRP_RCPT_TOT>>",numberWithCommas(grpRcptTot))).replace("<<GRP_BAL_TOT>>",numberWithCommas(grpBalTot)),newbilline=JSON.parse(strline);pdfdd.content[0].table.body[3][0].table.body.push(newbilline)}strline=strGrpline.replace("<<GROUP_ID>>",osdata[i].GRP_CODE),newbilline=JSON.parse(strline);pdfdd.content[0].table.body[3][0].table.body.push(newbilline),grpBalTot=grpRcptTot=grpBillTot=0,grpid=osdata[i].GRP_CODE}billDate=strDateDDMMYYYY(osdata[i].BILL_DT);strline=(strline=(strline=(strline=(strline=(strline=(strline=strbillline.replace("<<PARTY_NAME>>",osdata[i].AC_CODE+" - "+osdata[i].AC_NAME)).replace("<<CO_NAME>>",osdata[i].COMPANY)).replace("<<BILL>>",osdata[i].BILL_NO)).replace("<<BILL_DT>>",billDate)).replace("<<BILL_AMT>>",numberWithCommas(osdata[i].TOT_AMT))).replace("<<RCPT_AMT>>",numberWithCommas(osdata[i].RCPT_AMT))).replace("<<BAL_AMT>>",numberWithCommas(osdata[i].BAL_AMT));grpBillTot+=osdata[i].TOT_AMT,grpRcptTot+=osdata[i].RCPT_AMT,grpBalTot+=osdata[i].BAL_AMT;newbilline=JSON.parse(strline);pdfdd.content[0].table.body[3][0].table.body.push(newbilline)}strline=(strline=(strline=strGrpTot.replace("<<GRP_BILL_TOT>>",numberWithCommas(grpBillTot))).replace("<<GRP_RCPT_TOT>>",numberWithCommas(grpRcptTot))).replace("<<GRP_BAL_TOT>>",numberWithCommas(grpBalTot)),newbilline=JSON.parse(strline);pdfdd.content[0].table.body[3][0].table.body.push(newbilline),pdfdd.content[0].table.body[3][0].table.body.splice(2,1),pdfdd.content[0].table.body[3][0].table.body.splice(1,1),pdfdd.content[0].table.body[3][0].table.body.splice(0,1),pdfMake.createPdf(pdfdd).open({},win)}else;})}else alert("No group selected for printing !!"),$scope.rtnMessage="No groups selected !!",$scope.isRtnMsgErr="Yes"},$scope.orderByMe=function(x){x===$scope.sortColumn?$scope.sortReverse=!$scope.sortReverse:($scope.sortColumn=x,$scope.sortReverse=!1)}}]),FeesApp.controller("BillRegCntrl",["$scope","$http","$rootScope","$location",function($scope,$http,$rootScope,$location){$scope.pagetitle="Bill Register",$scope.rtnMessage="",$scope.isRtnMsgErr="",$scope.rtnMessageColor="alert alert-success",$scope.selectedComp={};$http.get("/Outstandings/listall").then(function(response){$scope.companylist=response.data,$scope.codata=""}),$scope.rtnMessageColor="Yes"==$scope.isRtnMsgErr?"alert alert-danger":"alert alert-success",$scope.PrintCancel=function(){var approotpath=$location.protocol()+"://"+$location.host()+":"+$location.port();console.log(approotpath),window.open(approotpath,"_self")},$scope.PrintBillReg=function(){var win=window.open("","_blank"),pdfdd={},paramdata={},mydoc=JSON.stringify(ddbillReg);pdfdd=JSON.parse(mydoc);JSON.stringify(pdfdd.content[0].table.body[2][0].table.body[0]),JSON.stringify(pdfdd.content[0].table.body[2][0].table.body[1]),JSON.stringify(pdfdd.content[0].table.body[3][0].table.body[0]);var strHdr1col=JSON.stringify(pdfdd.content[0].table.body[2][0].table.body[0][4]),strHdr2col=JSON.stringify(pdfdd.content[0].table.body[2][0].table.body[1][4]),strDatacol=JSON.stringify(pdfdd.content[0].table.body[3][0].table.body[0][4]),strGTotCol=JSON.stringify(pdfdd.content[0].table.body[4][0].table.body[0][4]);pdfdd.content[0].table.body[2][0].table.body[0].splice(4,10),pdfdd.content[0].table.body[2][0].table.body[1].splice(4,10),pdfdd.content[0].table.body[3][0].table.body[0].splice(4,10),pdfdd.content[0].table.body[3][0].table.body[1].splice(4,10),pdfdd.content[0].table.body[4][0].table.body[0].splice(4,10),mydoc=JSON.stringify(pdfdd),$http.get("../bills/CurrentCoData").then(function(response){response.data.CO_CODE?(paramdata.CO_CODE=response.data.CO_CODE,paramdata.CO_NAME=response.data.COMPANY,$http.get("/billreg/CurrentYearData").then(function(response){paramdata.YEAR=response.data.YEAR,paramdata.FROM_DT=response.data.FROM_DT,paramdata.TO_DT=response.data.TO_DT;var fromDate,todaysDt=appToday();fromDate=paramdata.FROM_DT.substring(8,10)+"/"+paramdata.FROM_DT.substring(5,7)+"/"+paramdata.FROM_DT.substring(0,4);var toDate;toDate=paramdata.TO_DT.substring(8,10)+"/"+paramdata.TO_DT.substring(5,7)+"/"+paramdata.TO_DT.substring(0,4),mydoc=(mydoc=(mydoc=(mydoc=mydoc.replace(/<<CO_NAME>>/g,paramdata.CO_NAME)).replace(/<<FROM_DT>>/g,fromDate)).replace(/<<TO_DT>>/g,toDate)).replace(/<<PRINT_DT>>/g,todaysDt),pdfdd=JSON.parse(mydoc),$http.post("/billreg/headernames",paramdata).then(function(resp){for(var hdrdata=resp.data,i=0;i<hdrdata.length;i++){(jHdr=JSON.parse(strHdr1col)).text=hdrdata[i].DESC,pdfdd.content[0].table.body[2][0].table.body[0].push(jHdr)}(jHdr=JSON.parse(strHdr1col)).text="Previous Balance",pdfdd.content[0].table.body[2][0].table.body[0].push(jHdr),(jHdr=JSON.parse(strHdr1col)).text="Total",pdfdd.content[0].table.body[2][0].table.body[0].push(jHdr);for(i=0;i<hdrdata.length;i++){(jHdr=JSON.parse(strHdr2col)).text=hdrdata[i].TRCD,pdfdd.content[0].table.body[2][0].table.body[1].push(jHdr)}(jHdr=JSON.parse(strHdr2col)).text=" ",pdfdd.content[0].table.body[2][0].table.body[1].push(jHdr),(jHdr=JSON.parse(strHdr2col)).text=" ",pdfdd.content[0].table.body[2][0].table.body[1].push(jHdr);for(i=0;i<hdrdata.length;i++){(jHdr=JSON.parse(strGTotCol)).text="<<GT"+hdrdata[i].TRCD+">>",pdfdd.content[0].table.body[4][0].table.body[0].push(jHdr),hdrdata[i].Amount=0}(jHdr=JSON.parse(strGTotCol)).text="<<GTOST>>",pdfdd.content[0].table.body[4][0].table.body[0].push(jHdr),(jHdr=JSON.parse(strGTotCol)).text="<<GTTOT>>",pdfdd.content[0].table.body[4][0].table.body[0].push(jHdr);for(i=0;i<hdrdata.length;i++){var jHdr;(jHdr=JSON.parse(strDatacol)).text="<<"+hdrdata[i].TRCD+">>",pdfdd.content[0].table.body[3][0].table.body[0].push(jHdr)}(jHdr=JSON.parse(strDatacol)).text="<<OST>>",pdfdd.content[0].table.body[3][0].table.body[0].push(jHdr),(jHdr=JSON.parse(strDatacol)).text="<<TOTAL>>",pdfdd.content[0].table.body[3][0].table.body[0].push(jHdr);for(i=0;i<hdrdata.length;i++)pdfdd.content[0].table.body[3][0].table.body[1].push({});pdfdd.content[0].table.body[3][0].table.body[1].push({}),pdfdd.content[0].table.body[3][0].table.body[1].push({}),pdfdd.content[0].table.body[3][0].table.body[1][1].colSpan=hdrdata.length+2+3;var billLine1=JSON.stringify(pdfdd.content[0].table.body[3][0].table.body[0]),billLine2=JSON.stringify(pdfdd.content[0].table.body[3][0].table.body[1]);$http.post("/billreg/billsdata",paramdata).then(function(response){for(var billdata=response.data,billTot=0,curBillId=billdata[0].BILLID,trcdData="(",dataln1=billLine1,OSTgrandTotal=0,GrandTotal=0,i=0;i<billdata.length;i++){for(var j=0;j<hdrdata.length;j++)if(hdrdata[j].TRCD==billdata[i].TRCD){hdrdata[j].Amount=hdrdata[j].Amount+billdata[i].BILLAMT;break}if("OST"==billdata[i].TRCD&&(OSTgrandTotal+=billdata[i].BILLAMT),GrandTotal+=billdata[i].BILLAMT,curBillId!=billdata[i].BILLID){var billDate;billDate=billdata[i-1].BILL_DT.substring(8,10)+"/"+billdata[i-1].BILL_DT.substring(5,7)+"/"+billdata[i-1].BILL_DT.substring(0,4),dataln1=(dataln1=(dataln1=(dataln1=(dataln1=dataln1.replace("<<BILLNO>>",billdata[i-1].BILL_NO)).replace("<<BILL_DT>>",billDate)).replace("<<PARTY_NAME>>",billdata[i-1].AC_NAME)).replace("<<AC_CODE>>",billdata[i-1].AC_CODE)).replace("<<TOTAL>>",numberWithCommas(billTot));for(var k=0;k<hdrdata.length;k++){var srchtrcd="<<"+hdrdata[k].TRCD+">>";dataln1=dataln1.replace(srchtrcd,"-")}dataln1=dataln1.replace("<<OST>>","-"),pdfdd.content[0].table.body[3][0].table.body.push(JSON.parse(dataln1)),trcdData+=")";var dataln2=billLine2.replace(/<<TRCD_DATA>>/g,trcdData);pdfdd.content[0].table.body[3][0].table.body.push(JSON.parse(dataln2)),curBillId=billdata[i].BILLID,trcdData="("+billdata[i].TRANLIST,billTot=billdata[i].BILLAMT,dataln1=billLine1;srchtrcd="<<"+billdata[i].TRCD+">>";dataln1=dataln1.replace(srchtrcd,numberWithCommas(billdata[i].BILLAMT))}else{trcdData=trcdData+" , "+billdata[i].TRANLIST;srchtrcd="<<"+billdata[i].TRCD+">>";dataln1=dataln1.replace(srchtrcd,numberWithCommas(billdata[i].BILLAMT)),billTot+=billdata[i].BILLAMT}}pdfdd.content[0].table.body[3][0].table.body.splice(0,2),mydoc=JSON.stringify(pdfdd);for(j=0;j<hdrdata.length;j++){srchtrcd="<<GT"+hdrdata[j].TRCD+">>";mydoc=mydoc.replace(srchtrcd,numberWithCommas(hdrdata[j].Amount))}mydoc=(mydoc=mydoc.replace("<<GTOST>>",numberWithCommas(OSTgrandTotal))).replace("<<GTTOT>>",numberWithCommas(GrandTotal)),pdfdd=JSON.parse(mydoc),pdfMake.createPdf(pdfdd).open({},win)})})})):$scope.isIncorrectGroup=!0})}}]),FeesApp.controller("LedgerCntrl",["$scope","$http","$rootScope","$location",function($scope,$http,$rootScope,$location){$scope.pagetitle="Ledgers",$scope.rtnMessage="",$scope.isRtnMsgErr="",$scope.rtnMessageColor="alert alert-success",$scope.selectedComp={};$http.get("../Parties/listall").then(function(response){$scope.partylist=response.data}),$http.get("../billreg/CurrentYearData").then(function(response){$scope.dtFromDate=new Date(response.data.FROM_DT),$scope.dtToDate=new Date(response.data.TO_DT)}),$scope.rtnMessageColor="Yes"==$scope.isRtnMsgErr?"alert alert-danger":"alert alert-success",$scope.PrintCancel=function(){var approotpath=$location.protocol()+"://"+$location.host()+":"+$location.port();console.log(approotpath),window.open(approotpath,"_self")},$scope.PrintLedger=function(){var processreport=!0,selectioncount=0,dataOptions=JSON.parse('{"datascope" : 1, "grouplist" : "NA", "partylist" : "NA"}');if(2==$scope.ReportOption){for(var selLedstr="(",i=0;i<$scope.partylist.length;i++)$scope.partylist[i].CHECKED&&(selLedstr=selLedstr+"'"+$scope.partylist[i].AC_CODE+"',",selectioncount+=1);selLedstr=0<selectioncount?selLedstr.substr(0,selLedstr.length-1)+")":"( 'NA' )",dataOptions.datascope=2,dataOptions.partylist=selLedstr}if(2==$scope.ReportOption&&0==selectioncount&&(processreport=!1),processreport){var win=window.open("","_blank"),pdfdd={},mydoc=JSON.stringify(ddLedger);pdfdd=JSON.parse(mydoc),$http.get("../bills/CurrentCoData").then(function(response){if(response.data.CO_CODE){dataOptions.CO_CODE=response.data.CO_CODE,dataOptions.CO_NAME=response.data.COMPANY,dataOptions.FROM_DT=dateinYYYYMMDD($scope.dtFromDate),dataOptions.TO_DT=dateinYYYYMMDD($scope.dtToDate);var todaysDt=appToday();mydoc=(mydoc=(mydoc=(mydoc=mydoc.replace(/<<CO_NAME>>/g,dataOptions.CO_NAME)).replace(/<<FROM_DT>>/g,dateinDDMMYYYY($scope.dtFromDate))).replace(/<<TO_DT>>/g,dateinDDMMYYYY($scope.dtToDate))).replace(/<<PRINT_DT>>/g,todaysDt),pdfdd=JSON.parse(mydoc);var accHdrLine=JSON.stringify(pdfdd.content[0].table.body[2][0].table.body[0]),coHdrsLine=JSON.stringify(pdfdd.content[0].table.body[2][0].table.body[1]),tranLine=JSON.stringify(pdfdd.content[0].table.body[2][0].table.body[2]),totLine=JSON.stringify(pdfdd.content[0].table.body[2][0].table.body[3]),blankLine=JSON.stringify(pdfdd.content[0].table.body[2][0].table.body[4]);$http.post("/ledgers/ledgerdata",dataOptions).then(function(response){for(var trandata=response.data,isPrintTotLine=!1,curAcCode=" ",balAmount=0,debitTotal=0,creditTotal=0,i=0;i<trandata.length;i++){if(curAcCode!=trandata[i].AC_CODE){balAmount=trandata[i].BAL_AMT,creditTotal=debitTotal=0;var dataln=" ";dataln=(dataln=accHdrLine.replace("<<AC_CODE>>",trandata[i].AC_CODE)).replace("<<AC_NAME>>",trandata[i].AC_NAME),pdfdd.content[0].table.body[2][0].table.body.push(JSON.parse(dataln)),pdfdd.content[0].table.body[2][0].table.body.push(JSON.parse(coHdrsLine))}if(balAmount=balAmount+trandata[i].BILL_AMOUNT-trandata[i].RCPT_AMOUNT,dataln=(dataln=(dataln=(dataln=(dataln=(dataln=tranLine.replace("<<TRAN_DT>>",trandata[i].TRAN_DT)).replace("<<NO>>"," ")).replace("<<PARTICULARS>>",trandata[i].TRAN)).replace("<<BILL_AMT>>",trandata[i].BILL_AMOUNT)).replace("<<RCPT_AMT>>",trandata[i].RCPT_AMOUNT)).replace("<<BAL_AMT>>",balAmount),pdfdd.content[0].table.body[2][0].table.body.push(JSON.parse(dataln)),debitTotal+=trandata[i].BILL_AMOUNT,creditTotal+=trandata[i].RCPT_AMOUNT,curAcCode=trandata[i].AC_CODE,isPrintTotLine=!1,i+1==trandata.length?isPrintTotLine=!0:curAcCode!=trandata[i+1].AC_CODE&&(isPrintTotLine=!0),1==isPrintTotLine)dataln=(dataln=(dataln=totLine.replace("<<BILLAMT_TOT>>",debitTotal)).replace("<<RCPTAMT_TOT>>",creditTotal)).replace("<<BALAMT_TOT>>",balAmount),pdfdd.content[0].table.body[2][0].table.body.push(JSON.parse(dataln)),pdfdd.content[0].table.body[2][0].table.body.push(JSON.parse(blankLine))}pdfdd.content[0].table.body[2][0].table.body.splice(3,1),pdfdd.content[0].table.body[2][0].table.body.splice(2,1),pdfdd.content[0].table.body[2][0].table.body.splice(1,1),pdfdd.content[0].table.body[2][0].table.body.splice(0,1),pdfMake.createPdf(pdfdd).open({},win)})}else $scope.isIncorrectGroup=!0})}else alert("No group selected for printing !!"),$scope.rtnMessage="No groups selected !!",$scope.isRtnMsgErr="Yes"}}]),FeesApp.controller("rcptregCntrl",["$scope","$http","$rootScope","$location",function($scope,$http,$rootScope,$location){$scope.pagetitle="Receipt register",$scope.sortColumn="CO_CODE",$scope.sortReverse=!1,$scope.rtnMessage="",$scope.isRtnMsgErr="",$scope.rtnMessageColor="alert alert-success";$http.get("../groups/listall").then(function(response){$scope.grouplist=response.data}),$http.get("../billreg/CurrentYearData").then(function(response){$scope.dtFromDate=new Date(response.data.FROM_DT),$scope.dtToDate=new Date(response.data.TO_DT)}),$scope.rtnMessageColor="Yes"==$scope.isRtnMsgErr?"alert alert-danger":"alert alert-success",$scope.PrintCancel=function(){var approotpath=$location.protocol()+"://"+$location.host()+":"+$location.port();console.log(approotpath),window.open(approotpath,"_self")},$scope.PrintRcptReport=function(){var processreport=!0,selectioncount=0,dataOptions=JSON.parse('{"datascope" : 1, "grouplist" : "NA", "partylist" : "NA"}');if(2==$scope.ReportOption){for(var selgroupstring="(",i=0;i<$scope.grouplist.length;i++)$scope.grouplist[i].CHECKED&&(selgroupstring=selgroupstring+"'"+$scope.grouplist[i].GRP_CODE+"',",selectioncount+=1);selgroupstring=0<selectioncount?selgroupstring.substr(0,selgroupstring.length-1)+")":"( 'NA' )",dataOptions.datascope=2,dataOptions.grouplist=selgroupstring}if(2==$scope.ReportOption&&0==selectioncount&&(processreport=!1),processreport){var win=window.open("","_blank"),pdfdd={};$http.get("../bills/CurrentCoData").then(function(response){response.data.CO_CODE?(dataOptions.CO_CODE=response.data.CO_CODE,dataOptions.CO_NAME=response.data.COMPANY,dataOptions.FROM_DT=dateinYYYYMMDD($scope.dtFromDate),dataOptions.TO_DT=dateinYYYYMMDD($scope.dtToDate),dataOptions.RcptOption=$scope.RcptOption,$http.post("/rcptreg/rcptregdata",dataOptions).then(function(response){if(response.data){var rcptdata=response.data,mydoc=JSON.stringify(ddrcptReg),todaysDt=appToday();mydoc=(mydoc=(mydoc=(mydoc=mydoc.replace(/<<CO_NAME>>/g,dataOptions.CO_NAME)).replace(/<<FROM_DT>>/g,strDateDDMMYYYY(dataOptions.FROM_DT))).replace(/<<TO_DT>>/g,strDateDDMMYYYY(dataOptions.TO_DT))).replace(/<<PRINT_DT>>/g,todaysDt),pdfdd=JSON.parse(mydoc);for(var strdataline=JSON.stringify(pdfdd.content[0].table.body[3][0].table.body[0]),strTotline=JSON.stringify(pdfdd.content[0].table.body[3][0].table.body[1]),billTot=0,cashTot=0,chqTot=0,rcptTot=0,i=0;i<rcptdata.length;i++){var strline=" ";strline=(strline=(strline=(strline=(strline=(strline=(strline=strdataline.replace("<<PARTY_NAME>>",rcptdata[i].AC_NAME)).replace("<<BILL>>",rcptdata[i].BILL_NO)).replace("<<BILL_AMT>>",numberWithCommas(rcptdata[i].TOT_AMT))).replace("<<RCPT_DT>>",strDateDDMMYYYY(rcptdata[i].RCPT_DATE))).replace("<<CASH_AMT>>",numberWithCommas(rcptdata[i].CASH1))).replace("<<CHQ_AMT>>",numberWithCommas(rcptdata[i].CHEQUE1))).replace("<<RCPT_AMT>>",numberWithCommas(rcptdata[i].RCPT_AMOUNT)),billTot+=rcptdata[i].TOT_AMT,cashTot+=rcptdata[i].CASH1,chqTot+=rcptdata[i].CHEQUE1,rcptTot+=rcptdata[i].RCPT_AMOUNT;var newbilline=JSON.parse(strline);pdfdd.content[0].table.body[3][0].table.body.push(newbilline)}strline=(strline=(strline=(strline=strTotline.replace("<<BILL_TOT>>",numberWithCommas(billTot))).replace("<<CASH_TOT>>",numberWithCommas(cashTot))).replace("<<CHQ_TOT>>",numberWithCommas(chqTot))).replace("<<RCPT_TOT>>",numberWithCommas(rcptTot)),newbilline=JSON.parse(strline);pdfdd.content[0].table.body[3][0].table.body.push(newbilline),pdfdd.content[0].table.body[3][0].table.body.splice(1,1),pdfdd.content[0].table.body[3][0].table.body.splice(0,1),pdfMake.createPdf(pdfdd).open({},win)}else;})):$scope.isIncorrectGroup=!0})}else alert("No group selected for printing !!"),$scope.rtnMessage="No groups selected !!",$scope.isRtnMsgErr="Yes"},$scope.orderByMe=function(x){x===$scope.sortColumn?$scope.sortReverse=!$scope.sortReverse:($scope.sortColumn=x,$scope.sortReverse=!1)}}]),FeesApp.controller("TallyExportCntrl",["$scope","$http","$location",function($scope,$http,$location){$scope.pagetitle="Export to Tally",$scope.rtnMessage="",$scope.isRtnMsgErr="",$scope.rtnMessageColor="alert alert-success",$scope.selectedComp={},$scope.tallyconfig={},$scope.tallyconfig.TALLYSERVER=" ",$scope.tallyconfig.TALLYEXPORTPARTYOPTION=1,$scope.tallyconfig.TALLYLEDGER="Not Available",$scope.tallyconfig.isReExport=!1,$scope.pageDataLoaded=!1;$http.get("../Parties/listall").then(function(response){$scope.partylist=response.data,$scope.pageDataLoaded=!0}),$http.get("../billreg/CurrentYearData").then(function(response){$scope.dtFromDate=new Date(response.data.FROM_DT),$scope.dtToDate=new Date(response.data.TO_DT)}),$http.get("/tallyexport/TallyConfig").then(function(response){for(var i=0;i<response.data.length;i++)"TALLYSERVER"==response.data[i].config_field&&($scope.tallyconfig.TALLYSERVER=response.data[i].config_value_str),"TALLYEXPORTPARTYOPTION"==response.data[i].config_field&&($scope.tallyconfig.TALLYEXPORTPARTYOPTION=response.data[i].config_value_str),"TALLYLEDGER"==response.data[i].config_field&&($scope.tallyconfig.TALLYLEDGER=response.data[i].config_value_str)}),$scope.rtnMessageColor="Yes"==$scope.isRtnMsgErr?"alert alert-danger":"alert alert-success",$scope.ExportCancel=function(){var approotpath=$location.protocol()+"://"+$location.host()+":"+$location.port();console.log(approotpath),window.open(approotpath,"_self")},$scope.ExportTallyData=function(){var processExport=!0,selectioncount=0,dataOptions=JSON.parse('{"TALLYSERVER" : " ", "exportscope" : 1, "reExport" : false , "FROM_DT" : "", "TO_DT" : "",  "grouplist" : "NA", "partylist" : "NA"}');if(dataOptions.exportscope=$scope.ExportOption,2==$scope.ExportOption){for(var selpartystring="(",i=0;i<$scope.partylist.length;i++)$scope.partylist[i].CHECKED&&(selpartystring=selpartystring+"'"+$scope.partylist[i].AC_CODE+"',",selectioncount+=1);selpartystring=0<selectioncount?selpartystring.substr(0,selpartystring.length-1)+")":"( 'NA' )",dataOptions.exportscope=2,dataOptions.partylist=selpartystring}2==$scope.ExportOption&&0==selectioncount&&(processExport=!1),dataOptions.TALLYSERVER=$scope.tallyconfig.TALLYSERVER,dataOptions.reExport=$scope.tallyconfig.isReExport,dataOptions.FROM_DT=dateinYYYYMMDD($scope.dtFromDate),dataOptions.TO_DT=dateinYYYYMMDD($scope.dtToDate),$http.post("/tallyexport/UpdateTServer",dataOptions).then(function(response){1==$scope.ExportOption?$http.post("/tallyexport/SendtoTally",dataOptions).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error,ShowSnackbar($scope.rtnMessage,0)}):processExport&&$http.post("/tallyexport/SendCCtoTally",dataOptions).then(function(response){$scope.rtnMessage=response.data.message,$scope.isRtnMsgErr=response.data.error,ShowSnackbar($scope.rtnMessage,0)})})},$scope.tobedeleted=function(){var selectioncount=0,dataOptions=JSON.parse('{"datascope" : 1, "grouplist" : "NA", "partylist" : "NA"}');if(2==$scope.ReportOption){for(var selLedstr="(",i=0;i<$scope.partylist.length;i++)$scope.partylist[i].CHECKED&&(selLedstr=selLedstr+"'"+$scope.partylist[i].AC_CODE+"',",selectioncount+=1);selLedstr=0<selectioncount?selLedstr.substr(0,selLedstr.length-1)+")":"( 'NA' )",dataOptions.datascope=2,dataOptions.partylist=selLedstr}if(2==$scope.ReportOption&&0==selectioncount&&(processreport=!1),processreport){var win=window.open("","_blank"),pdfdd={},mydoc=JSON.stringify(ddLedger);pdfdd=JSON.parse(mydoc),$http.get("../bills/CurrentCoData").then(function(response){if(response.data.CO_CODE){dataOptions.CO_CODE=response.data.CO_CODE,dataOptions.CO_NAME=response.data.COMPANY,dataOptions.FROM_DT=dateinYYYYMMDD($scope.dtFromDate),dataOptions.TO_DT=dateinYYYYMMDD($scope.dtToDate);var todaysDt=appToday();mydoc=(mydoc=(mydoc=(mydoc=mydoc.replace(/<<CO_NAME>>/g,dataOptions.CO_NAME)).replace(/<<FROM_DT>>/g,dateinDDMMYYYY($scope.dtFromDate))).replace(/<<TO_DT>>/g,dateinDDMMYYYY($scope.dtToDate))).replace(/<<PRINT_DT>>/g,todaysDt),pdfdd=JSON.parse(mydoc);var accHdrLine=JSON.stringify(pdfdd.content[0].table.body[2][0].table.body[0]),coHdrsLine=JSON.stringify(pdfdd.content[0].table.body[2][0].table.body[1]),tranLine=JSON.stringify(pdfdd.content[0].table.body[2][0].table.body[2]),totLine=JSON.stringify(pdfdd.content[0].table.body[2][0].table.body[3]),blankLine=JSON.stringify(pdfdd.content[0].table.body[2][0].table.body[4]);$http.post("/ledgers/ledgerdata",dataOptions).then(function(response){for(var trandata=response.data,isPrintTotLine=!1,curAcCode=" ",balAmount=0,debitTotal=0,creditTotal=0,i=0;i<trandata.length;i++){if(curAcCode!=trandata[i].AC_CODE){balAmount=trandata[i].BAL_AMT,creditTotal=debitTotal=0;var dataln=" ";dataln=(dataln=accHdrLine.replace("<<AC_CODE>>",trandata[i].AC_CODE)).replace("<<AC_NAME>>",trandata[i].AC_NAME),pdfdd.content[0].table.body[2][0].table.body.push(JSON.parse(dataln)),pdfdd.content[0].table.body[2][0].table.body.push(JSON.parse(coHdrsLine))}if(balAmount=balAmount+trandata[i].BILL_AMOUNT-trandata[i].RCPT_AMOUNT,dataln=(dataln=(dataln=(dataln=(dataln=(dataln=tranLine.replace("<<TRAN_DT>>",trandata[i].TRAN_DT)).replace("<<NO>>"," ")).replace("<<PARTICULARS>>",trandata[i].TRAN)).replace("<<BILL_AMT>>",trandata[i].BILL_AMOUNT)).replace("<<RCPT_AMT>>",trandata[i].RCPT_AMOUNT)).replace("<<BAL_AMT>>",balAmount),pdfdd.content[0].table.body[2][0].table.body.push(JSON.parse(dataln)),debitTotal+=trandata[i].BILL_AMOUNT,creditTotal+=trandata[i].RCPT_AMOUNT,curAcCode=trandata[i].AC_CODE,isPrintTotLine=!1,i+1==trandata.length?isPrintTotLine=!0:curAcCode!=trandata[i+1].AC_CODE&&(isPrintTotLine=!0),1==isPrintTotLine)dataln=(dataln=(dataln=totLine.replace("<<BILLAMT_TOT>>",debitTotal)).replace("<<RCPTAMT_TOT>>",creditTotal)).replace("<<BALAMT_TOT>>",balAmount),pdfdd.content[0].table.body[2][0].table.body.push(JSON.parse(dataln)),pdfdd.content[0].table.body[2][0].table.body.push(JSON.parse(blankLine))}pdfdd.content[0].table.body[2][0].table.body.splice(3,1),pdfdd.content[0].table.body[2][0].table.body.splice(2,1),pdfdd.content[0].table.body[2][0].table.body.splice(1,1),pdfdd.content[0].table.body[2][0].table.body.splice(0,1),pdfMake.createPdf(pdfdd).open({},win)})}else $scope.isIncorrectGroup=!0})}else alert("No group selected for printing !!"),$scope.rtnMessage="No groups selected !!",$scope.isRtnMsgErr="Yes"}}]),FeesApp.controller("LedgerCntrl",["$scope","$http","$rootScope","$location",function($scope,$http,$rootScope,$location){$scope.pagetitle="Ledgers",$scope.rtnMessage="",$scope.isRtnMsgErr="",$scope.rtnMessageColor="alert alert-success",$scope.selectedComp={};$http.get("../Parties/listall").then(function(response){$scope.partylist=response.data}),$http.get("../billreg/CurrentYearData").then(function(response){$scope.dtFromDate=new Date(response.data.FROM_DT),$scope.dtToDate=new Date(response.data.TO_DT)}),$scope.rtnMessageColor="Yes"==$scope.isRtnMsgErr?"alert alert-danger":"alert alert-success",$scope.PrintCancel=function(){var approotpath=$location.protocol()+"://"+$location.host()+":"+$location.port();console.log(approotpath),window.open(approotpath,"_self")},$scope.PrintLedger=function(){var processreport=!0,selectioncount=0,dataOptions=JSON.parse('{"datascope" : 1, "grouplist" : "NA", "partylist" : "NA"}');if(2==$scope.ReportOption){for(var selLedstr="(",i=0;i<$scope.partylist.length;i++)$scope.partylist[i].CHECKED&&(selLedstr=selLedstr+"'"+$scope.partylist[i].AC_CODE+"',",selectioncount+=1);selLedstr=0<selectioncount?selLedstr.substr(0,selLedstr.length-1)+")":"( 'NA' )",dataOptions.datascope=2,dataOptions.partylist=selLedstr}if(2==$scope.ReportOption&&0==selectioncount&&(processreport=!1),processreport){var win=window.open("","_blank"),pdfdd={},mydoc=JSON.stringify(ddLedger);pdfdd=JSON.parse(mydoc),$http.get("../bills/CurrentCoData").then(function(response){if(response.data.CO_CODE){dataOptions.CO_CODE=response.data.CO_CODE,dataOptions.CO_NAME=response.data.COMPANY,dataOptions.FROM_DT=dateinYYYYMMDD($scope.dtFromDate),dataOptions.TO_DT=dateinYYYYMMDD($scope.dtToDate);var todaysDt=appToday();mydoc=(mydoc=(mydoc=(mydoc=mydoc.replace(/<<CO_NAME>>/g,dataOptions.CO_NAME)).replace(/<<FROM_DT>>/g,dateinDDMMYYYY($scope.dtFromDate))).replace(/<<TO_DT>>/g,dateinDDMMYYYY($scope.dtToDate))).replace(/<<PRINT_DT>>/g,todaysDt),pdfdd=JSON.parse(mydoc);var accHdrLine=JSON.stringify(pdfdd.content[0].table.body[2][0].table.body[0]),coHdrsLine=JSON.stringify(pdfdd.content[0].table.body[2][0].table.body[1]),tranLine=JSON.stringify(pdfdd.content[0].table.body[2][0].table.body[2]),totLine=JSON.stringify(pdfdd.content[0].table.body[2][0].table.body[3]),blankLine=JSON.stringify(pdfdd.content[0].table.body[2][0].table.body[4]);$http.post("/ledgers/ledgerdata",dataOptions).then(function(response){for(var trandata=response.data,isPrintTotLine=!1,curAcCode=" ",balAmount=0,debitTotal=0,creditTotal=0,i=0;i<trandata.length;i++){if(curAcCode!=trandata[i].AC_CODE){balAmount=trandata[i].BAL_AMT,creditTotal=debitTotal=0;var dataln=" ";dataln=(dataln=accHdrLine.replace("<<AC_CODE>>",trandata[i].AC_CODE)).replace("<<AC_NAME>>",trandata[i].AC_NAME),pdfdd.content[0].table.body[2][0].table.body.push(JSON.parse(dataln)),pdfdd.content[0].table.body[2][0].table.body.push(JSON.parse(coHdrsLine))}if(balAmount=balAmount+trandata[i].BILL_AMOUNT-trandata[i].RCPT_AMOUNT,dataln=(dataln=(dataln=(dataln=(dataln=(dataln=tranLine.replace("<<TRAN_DT>>",trandata[i].TRAN_DT)).replace("<<NO>>"," ")).replace("<<PARTICULARS>>",trandata[i].TRAN)).replace("<<BILL_AMT>>",trandata[i].BILL_AMOUNT)).replace("<<RCPT_AMT>>",trandata[i].RCPT_AMOUNT)).replace("<<BAL_AMT>>",balAmount),pdfdd.content[0].table.body[2][0].table.body.push(JSON.parse(dataln)),debitTotal+=trandata[i].BILL_AMOUNT,creditTotal+=trandata[i].RCPT_AMOUNT,curAcCode=trandata[i].AC_CODE,isPrintTotLine=!1,i+1==trandata.length?isPrintTotLine=!0:curAcCode!=trandata[i+1].AC_CODE&&(isPrintTotLine=!0),1==isPrintTotLine)dataln=(dataln=(dataln=totLine.replace("<<BILLAMT_TOT>>",debitTotal)).replace("<<RCPTAMT_TOT>>",creditTotal)).replace("<<BALAMT_TOT>>",balAmount),pdfdd.content[0].table.body[2][0].table.body.push(JSON.parse(dataln)),pdfdd.content[0].table.body[2][0].table.body.push(JSON.parse(blankLine))}pdfdd.content[0].table.body[2][0].table.body.splice(3,1),pdfdd.content[0].table.body[2][0].table.body.splice(2,1),pdfdd.content[0].table.body[2][0].table.body.splice(1,1),pdfdd.content[0].table.body[2][0].table.body.splice(0,1),pdfMake.createPdf(pdfdd).open({},win)})}else $scope.isIncorrectGroup=!0})}else alert("No group selected for printing !!"),$scope.rtnMessage="No groups selected !!",$scope.isRtnMsgErr="Yes"}}]),FeesApp.controller("navBarCntrl",["$scope","$http",function($scope,$http){}]),FeesApp.controller("navMenuCntrl",["$scope","$http",function($scope,$http){}]);